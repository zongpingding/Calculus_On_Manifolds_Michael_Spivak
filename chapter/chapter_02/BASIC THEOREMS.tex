\clearpage
\section{BASIC THEOREMS}
\begin{theorem}[Chain Rule]
    If $f:\F{R}^n\to \F{R}^m$ is differentiable at $a$, and $g: \F{R}^m\to \F{R}^p$ is 
    differentiable at $f(a)$, then the composition $g\circ f:\F{R}^n\to \F{R}^p$ is differentiable
    at $a$, and 
    \begin{align*}
        \R{D}\left(g\circ f\right)(a) = \R{D}g\left(f(a)\right)\circ \R{D}f(a)
    \end{align*}

    Remark.~ This equation can be written 
    \begin{align*}
        (g\circ f)'(a) = g'(f(a))\cdot f'(a)
    \end{align*}
\end{theorem}

If $m=n=p=1$, we obtain the old chain rule.
\begin{proof}
    Let $b = f(a)$, let $\lambda = \R{D}f(a)$, and let $\mu = \R{D}g(f(a))$.
    If we define 
    \begin{align*}
        & \text{(1) }\varphi(x) = f(x) - f(a) - \lambda(x-a) \\
        & \text{(2) }\psi(x) = g(y) - g(b) - \mu(y-b)\\
        & \text{(3) }\rho(x) = g\circ f(x) - g\circ f(a) - \mu\circ \lambda(x-a)
    \end{align*}\relax
    then 
    \begin{align*}
        & \text{(4) } \displaystyle\lim_{x\to a}{\frac{|\varphi(x)|}{|x-a|}} = 0\\
        & \text{(5) } \displaystyle\lim_{y\to b}{\frac{|\psi(y)|}{|y-b|}} = 0
    \end{align*}
    and we must show that 
    \begin{align*}
        \lim_{x\to a}{\frac{|\rho(a)|}{|x-a|}} = 0
    \end{align*}\relax
    Now 
    \begin{align*}
        \rho(x) 
        & = g(f(x)) - g(b) - \mu(\lambda(x-a)) \\
        & = g(f(x)) - g(b) -\mu(f(x) - f(a) - \varphi(x))   \tag{\text{by (1)}} \\
        & = \left[g(f(x)) - g(b) - \mu(f(x) - f(a))\right] + \mu(\varphi(x)) \\
        & = \psi(f(x)) + \mu(\varphi(x))    \tag{\text{by (2)}}
    \end{align*}\relax 
    Thus we must prove
    \begin{align*}
        & \text{(6)} \lim_{x\to a}{\frac{|\psi(x)|}{|x-a|}} = 0 \\
        & \text{(7)} \lim_{x\to a}{\frac{|\mu(\varphi(x))|}{|x-a|}} = 0
    \end{align*}

    Equation (7) follows easily from (4) and Problem 1-10. If $\varepsilon>0$ it follows
    from (5) that for some $\delta >0$ we have 
    \begin{align*}
        \left|\psi(f(x))\right| < \varepsilon|f(x) - b| \qquad \text{ if } |f(x)-b|<\delta 
    \end{align*}\relax 
    which is true if $|x-a| < \delta_1$, for a suitable $\delta_1$. Then 
    \begin{align*}
        \left|\psi(f(x))\right| 
        & < \varepsilon|f(x)- b| \\
        & = \varepsilon|\varphi(x) + \lambda(x-a)| \\
        & \le \varepsilon|\varphi(x)| + \varepsilon M|x-a|
    \end{align*} 
    for some $M$, by Problem 1-10. Equation (6) now follows easily.
\end{proof}


\begin{theorem}
    \begin{enumerate}[label={\upshape(\arabic*)}]
        \item If $f:\F{R}^n\to \F{R}^m$ is a constant function (that is, if for some
            $y \in \F{R}^m$ we have $f(x) = y$ for all $x \in \F{R}^n$), then
            \begin{align*}
                \R{D}f(a) = 0
            \end{align*} 
        \item If $f:\F{R}^n\to \F{R}^m$ is a linear transformation, then
            \begin{align*}
                \R{D}f(a) = f
            \end{align*}
        \item If $f:\F{R}^n\to \F{R}^m$, then f is differentiable at $a\in \F{R}^n$ if and only if 
            each $f^i$ is, and 
            \begin{align*}
                \R{D}f(a) = \left(\R{D}f^1(a), \cdots, \R{D}f^m(a)\right)
            \end{align*}
            Thus $f'(a)$ is the $m\times n$ matrix whose $i$th row is $\left(f^i\right)'(a)$.
        \item If $s:\F{R}^2\to \F{R}$ is defined by $s(x, y) = x+y$, then 
            \begin{align*}
                \R{D}s(a, b) = s
            \end{align*}
        \item If $p:\F{R}^2\to \F{R}$ is defined by $p(x, y) = x\cdot y$, then 
            \begin{align*}
                \R{D}p(a, b)(x, y) = bx + ay
            \end{align*}
            Thus $p'(a, b) = (b, a)$.
    \end{enumerate}
\end{theorem}

\begin{proof}
    \begin{enumerate}[label={\upshape(\arabic*)}]
        \item 
            \begin{align*}
                \lim_{h\to0}\frac{\left|f(a+h)-f(a)-0\right|}{|h|}=\lim_{h\to0}\frac{|y-y-0|}{|h|}=0.        
            \end{align*}
        \item 
            \begin{align*}
                &\lim_{h\to0}\frac{\left|f(a+h)-f(a)-f(h)\right|}{|h|} \\
                &\hspace*{6em} = \lim_{h\to0}\frac{|f(a) + f(h) - f(a) - f(h)|}{|h|}=0.
            \end{align*}
        \item If each $f^i$ is differentiable at $a$ and
            \begin{align*}
                \lambda = \left(\R{D}f^1(a), \cdots, \R{D}f^m(a)\right)
            \end{align*}
            then 
            \begin{align*}
                f(a+h) - f(a) -\lambda(h) 
                & = \bigg(f^1(a+h) - f^1(a) - \R{D}f^1(a)(h), \cdots \\
                & \quad\cdots,f^m(a+h) + f^m(a) - \R{D}f^m(a)(h)\bigg) 
            \end{align*}
            Therefore 
            \begin{align*}
                & \lim_{h\to 0}{\frac{|f(a+h) - f(a) - \lambda(h)|}{|h|}} \\
                & \le \lim_{h\to 0}{\sum_{i=1 }^{m}{\frac{\displaystyle |f^i(a+h) - f^i(a) - \R{D}f^i(a)(h)|}{|h|}}} \\
                & = 0
            \end{align*}
            If on the other hand, $f$ is differentiable at $a$, then $f^i = \pi^i\circ f$ is differentiable at $a$ 
            by (2) and Theorem 2-2.
        \item Let $\lambda(x, y) = bx + ay$. Then 
            \begin{align*}
                \lim_{(h, k)\to 0}{\frac{|p(a+h, b+k) - P(a, b) - \lambda(h, k)|}{|(h, k)|}} 
                = \lim_{(h, k)\to 0}{\frac{|hk|}{|(h, k)|}}
            \end{align*}
            Now 
            \begin{align*}
                |hk| \le \left\{\begin{aligned}
                    & |h|^2 && \text{ if } |k| \le |h| \\
                    & |k|^2 && \text{ if } |h| \le |k|
                \end{aligned}\right.
            \end{align*}
            Hence $|hk|\le |h|^2 + |k|^2$. Therefore 
            \begin{align*}
                \frac{|hk|}{|(h, k)|} \le \frac{h^2 + k^2}{\sqrt{h^2 + k^2}} = \sqrt{h^2 + k^2}
            \end{align*}
            So 
            \begin{align*}
                \lim_{(h, k)\to 0}{\frac{|hk|}{|(h, k)|}} = 0
            \end{align*}
    \end{enumerate}
\end{proof}


\begin{corollary}
    If $f,g:\F{R}^n\to \F{R}$ are differentiable at $a$, then 
    \begin{align*}
        & \R{D}(f+g)(a) = \R{D}f(a) = \R{D}g(a) \\
        & \R{D}(f\cdot g)(a) = g(a)\cdot \R{D}f(a) + f(a)\cdot \R{D}g(a)
    \end{align*}
    If, moreover, $g(a)\neq 0$, then 
    \begin{align*}
        \R{D}(f/g)(a) = \frac{g(a)\cdot \R{D}f(a) - f(a)\cdot \R{D}g(a)}{\left[g(a)\right]^2}
    \end{align*} 
\end{corollary}

\begin{proof}
    We will prove the first equation and leave the others
    to the reader. Since $f+g = s\circ (f, g)$, we have 
    \begin{align*}
        \R{D}(f+g)(a)
        & = \R{D}s(f(a),g(a))\circ \R{D}(f,g)(a)  \\
        & = s\circ(\R{D}f(a),\R{D}g(a)) \\
        & = \R{D}f(a)+\R{D}g(a)
    \end{align*}
\end{proof}

We are now assured of the differentiability of those functions
$f:\F{R}^n \to \F{R}^m$, whose component functions are obtained by
addition, multiplication, division, and composition, from the
functions $\pi^i$ (which are linear transformations) and the functions 
which we can already differentiate by elementary calculus.
Finding $\R{D}f(x)$ or $f'(x)$, however, may be a fairly
formidable task. For example, let $f:\F{R}^2 \to \F{R}$ be defined by 
$f(x, y) = \sin(xy^2)$. Since $f=\sin\circ \left(\pi^1\cdot \left[\pi^2\right]^2\right)$,
we have 
\begin{align*}
    f^{\prime}(a{,}b)
    & = \sin^{\prime}(ab^{2})\cdot[b^{2}(\pi^{1})^{\prime}(a,b)+a([\pi^{2}]^{2})^{\prime}(a,b)]  \\
    & = \sin^{\prime}(ab^{2})\cdot[b^{2}(\pi^{1})^{\prime}(a,b)+2ab(\pi^{2})^{\prime}(a,b)] \\
    & = (\cos(ab^{2}))\cdot[b^{2}(1,0)+2ab(0,1)] \\
    & = (b^{2}\cos(ab^{2}),2ab\cos(ab^{2})).
\end{align*}
Fortunately, we will soon discover a much simpler method of computing $f'$.

\begin{problems}
    \problem{Use the theorems of this section to find $f^\prime$ for the following:\vspace*{-1em}
    \begin{multicols}{2}
    \begin{enumerate}[label={\upshape(\alph*)}]
        \item $f(x,y,z)=x^{y}$
        \item $f(x,y,z)=(x^{y},z)$
        \item $f(x,y)=\sin(x\sin y)$
        \item $f(x,y,z)=\sin(x\sin(y\sin z))$
        \item $f(x,y,z)=x^{y^{z}}$
        \item $f(x,y,z)=x^{y+z}$
        \item $f(x,y,z)=(x+y)^{z}$
        \item $f(x,y)=\sin{(xy)}$
        \item $f(x,y)=[\sin{(xy)}]^{\cos 3}$
        \item $f(x,y)=(\sin{(xy)},\sin{(x\sin{y})},x^{y})$
    \end{enumerate}\end{multicols}}
    \problem{Find $f'$ for the following (where $g:\F{R} \to \F{R}$ is continuous):\vspace*{-1em}
        \begin{multicols}{2}
        \begin{enumerate}[label={\upshape(\alph*)}]
            \item $\displaystyle f(x, y) = \int_{a}^{x+y}{g}$
            \item $\displaystyle f(x, y) = \int_{a}^{x\cdot y}{g}$
            \item $\displaystyle f(x, y) = \int_{a}^{\sin\left(x\cdot \sin\left(y\cdot \sin x\right)\right)}{g}$
        \end{enumerate}\end{multicols}}
    \problem{A function $f:\F{R}^n\times \F{R}^m \to \F{R}^p$ is \textbf{bilinear} for $x, x_1, x_2 \in \F{R}^n$
        $y, y_1, y_2\in \F{R}^m$, and $a\in \F{R}$ we have 
        \begin{align*}
            & f(ax, y) = af(x, y) = f(x, ay) \\
            & f(x_1+x_2), y) = f(x_1, y) + f(x_2, y) \\
            & f(x, y_1+ y_2) = f(x, y_1) + f(x, y_2) 
        \end{align*}
        \begin{enumerate}[label={\upshape(\alph*)}]
            \item Prove that if $f$ is bilinear, then 
                \begin{align*}
                    \lim_{(h,k)\to 0}{\frac{|f(h, k)|}{|(h, k)|}} = 0
                \end{align*}
            \item Prove that $\R{D}f(a, b)(x, y) = f(a, y) + f(x, b)$
            \item Show that the formula for $\R{D}p(a, b)$ in Theorem 2-3 is a special case of (b)
        \end{enumerate}
        } 
    \problem{Define $\R{IP}:\F{R}^n\times \F{R}^n\to \F{R}$ by $\R{IP}(x, y) = \langle x, y\rangle$
        \begin{enumerate}[label={\upshape(\alph*)}]
            \item Find $\R{D}(\R{IP})(a, b)$ and $(\R{IP})'(a, b)$.
            \item If $f, g:\F{R}\to \F{R}^n$ are differentiable and $h:\F{R}\to \F{R}$ is
                defined by $h(t)= \langle f(t), g(t)\rangle$, show that 
                \begin{align*}
                    h'(a) = \langle f'(a)^T, g(a)\rangle + \langle f(a), g'(a)^T\rangle 
                \end{align*}
                (Note that $f'(a)$ is a $n\times 1$ matrix; its transpose $f'(a)^T$ is a $1\times n$
                matrix, which we consider as a member of $\F{R}^n$.)
            \item If $f:\F{R}\to \F{R}^n$ is differentiable and $|f(t)| = 1$ for all $t$, show that 
                $\langle f'(t), f(t)\rangle = 0$.
            \item Exhibit a differentiable function $f:\F{R}\to \F{R}$ such that the function $|f|$ defined 
                by $|f|(t) = |f(t)|$ is not differentiable.
        \end{enumerate}
        }
    \problem{Let $E_i,i=1, \cdots, k$ be Euclidean space of various dimensions. A function $f:E_1\times\cdots \times E_k\to \F{R}^p$
        is called \textbf{multilinear} if for each choice $x_i\in E_j, j\neq i$ the function $g:E_i\to \F{R}^p$ defined by 
        $g(x) = f(x_1, \cdots, x_{i-1}, x, x_{i+1}, \cdots, x_k)$ is a linear transformation.
        \begin{enumerate}[label={\upshape(\alph*)}]
            \item If $f$ is multilinear and $i\neq j$, show that for $h=(h_1, \cdots, h_k)$, with 
                $h_i\in E_l$, we have 
                \begin{align*}
                    \lim_{h\to 0}{\frac{\left|f(a_1, \cdots, h_i, \cdots, h_j, \cdots, a_k)\right|}{|h|}} = 0
                \end{align*}
                \textit{Hint:} If $g(x, y)=f(a_1, \cdots, x, \cdots, y, \cdots, a_k)$, then $g$ is bilinear.
            \item Prove that 
                \begin{align*}
                    \R{D}f(a_1, \cdots, a_k)(x_1, \cdots, x_k) 
                    = \sum_{i=1 }^{k}{f(a_1, \cdots, a_{i-1}, x_i, a_{i+1}, \cdots, a_k)}
                \end{align*}
        \end{enumerate}
        }
    \problem{Regard an $n\times n$ matrix as a point in the $n$-fold product $\F{R}^n\times \cdots \times\F{R}^n$
        by considering each row as a member of $\F{R}^n$.
        \begin{enumerate}[label={\upshape(\alph*)}]
            \item Prove that det: $\F{R}^n\times \cdots \times \F{R}^n\to \F{R}$ is differentiable and 
                \begin{align*}
                    \R{D}(\det)(a_1, \cdots, a_n)(x_1, \cdots, x_n)
                    = \sum_{i=1}^{n}{\det \left(\begin{matrix}
                        a_1\\
                        \vdots \\
                        x_i \\
                        \vdots \\
                        a_n
                    \end{matrix}\right)}
                \end{align*}
            \item If $a_{ij}:\F{R}\to \F{R}$ are differentiable and $f(t) = \det(a_{ij}(t))$, show that 
                \begin{align*}
                    f'(t) = \sum_{j=1}^{n}{\det \left(\begin{matrix}
                        a_{11} & \cdots & a_{1n} \\
                        \vdots & & \vdots \\
                        a_{j1}'(t) & \cdots & a_{jn}'(t) \\
                        \vdots & & \vdots \\
                        a_{n1}(t) & \cdots & a_{nn}(t)
                    \end{matrix}\right)}
                \end{align*}
            \item If $\det (a_{ij}(t)) \neq 0$ for all $t$ and $b_1, \cdots, b_n:\F{R}\to \F{R}^n$ are 
                differentiable, let $s_1, \cdots, s_n:\F{R}\to \F{R}$ be the functions such that $s_1(t), \cdots, s_n(t)$
                are the solution of the equations 
                \begin{align*}
                    \sum_{j=1}^{n}{a_{ji}(t)\cdot s_j(t)} = b_i(t),\qquad i=1, \cdots, n.
                \end{align*}
                Show that $s_i$ is differentiable and find $s_i'(t)$.
        \end{enumerate}
        }
    \problem{Suppose $f:\F{R}^n\to \F{R}^n$ is differentiable and has a differentiable inverse 
        $f^{-1}:\F{R}^n\to \F{R}^n$.Show that $\left(f^{-1}\right)'(a) = \left[f'\left(f^{-1}(a)\right)\right]^{-1}$.
        \textit{Hint:} $f\circ f^{(-1)}(x) = x$.
        }
\end{problems}